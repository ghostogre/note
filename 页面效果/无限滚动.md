我们要实现的无限滚动是指的是，列表滚动的时候没有分页和加载更多，滚动的时候同时渲染空白的div和请求接口，滚动的时候渲染到空白div里面，滚动过去很多位置的时候回收以前的资源，往回滚动重新加载。

可以说就是虚拟列表的需求，与长列表稍微不同，长列表是一次加载许多个，这个是。

#### 需求

1. 在滚动的时候渲染空白div，但是还没返回数据，我们不能使用列表的ID，使用index的话假如列表顺序改变或者删除增加，会出现数据和列表无法对应（点击A商品跳到B商品的详情），最大渲染个数我们可以让后台返回total。
2. TabBar切换的列表，切换的时候要保留滚动的位置，这个时候就需要做资源回收（JD的TabBar列表因为tab极其多，所以没做资源回收），不然的话tab切换太多的时候就会占用过多内存。

#### 解决

1. 接口没返回数据渲染的话，我们就需要自己给他生成一个ID，例如hash值之类的，维护这个ID的字符串数组，然后维护一个商品列表的数组。

### Intersection Observer

提供一种便捷的新方法来**异步查询**元素相对于其他元素或视窗的位置，消除了昂贵的 DOM 查询和样式读取成本。

#### 一些应用场景

- 页面滚动时的懒加载实现。
- 无限下拉。
- 监测某些广告元素的曝光情况来做相关数据统计。
- 监测用户的滚动行为是否到达了目标位置来实现一些交互逻辑（比如视频元素滚动到隐藏位置时暂停播放）。

### padding 方案

- 监听一个固定长度列表的首尾元素是否进入视窗；
- 更新当前页面内渲染的第一个元素对应的序号；
- 根据上述序号，获取目标数据元素，列表内容重新渲染成对应内容；
- 容器 padding 调整，模拟滚动实现。

**本该由更多 DOM 元素进一步撑开容器高度的部分，我们用 padding 填充来模拟实现。**控制padding-top和padding-bottom实现滚动效果。

React-window 和 React-Virtualized

vue-virtual-scroller

https://mp.weixin.qq.com/s/R7NoaY-DHnKwacleZdzX4g

少人走的路

